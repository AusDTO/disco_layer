(function(){"use strict";function a(a,b){var c,d,b=b||"",e=-(1/0),f=1/0,g=1/0,h=-(1/0),i=-(1/0);for(c=0,d=a.length;d>c;c++)e=Math.max(a[c][b+"size"],e),h=Math.max(a[c][b+"x"],h),f=Math.min(a[c][b+"x"],f),i=Math.max(a[c][b+"y"],i),g=Math.min(a[c][b+"y"],g);return e=e||1,{sizeMax:e,minX:f,minY:g,maxX:h,maxY:i}}function b(a,b,c,d,e){return(e-d)*(a-b)/(c-b)+d}function c(a,c,d){return{x:b(a.x,c.minX,c.maxX,d.minX,d.maxX),y:b(a.y,c.minY,c.maxY,d.minY,d.maxY)}}function d(){var b,d=this;this.init=function(a,b){if(b=b||{},b.nodes&&(this.nodes=b.nodes,delete b.nodes),b.boundingBox&&(this.boundingBox=b.boundingBox,delete b.boundingBox),this.sigInst=a,this.config=sigma.utils.extend(b,e),this.easing=b.easing,this.duration=b.duration,this.easing&&(!sigma.plugins||"undefined"==typeof sigma.plugins.animate))throw new Error("sigma.plugins.animate is not declared");this.started=!1,this.running=!1},this.start=function(){if(!this.running&&(this.running=!0,!this.started)){b=new dagre.graphlib.Graph({directed:this.config.directed,multigraph:this.config.multigraph,compound:this.config.compound}),b.setGraph(this.config);for(var c=this.nodes||this.sigInst.graph.nodes(),e=0;e<c.length;e++)c[e].fixed||b.setNode(c[e].id,{});this.boundingBox===!0&&(this.boundingBox=a(c));for(var f=this.sigInst.graph.edges(),e=0;e<f.length;e++)null!=b.node(f[e].source)&&null!=b.node(f[e].target)&&b.setEdge(f[e].source,f[e].target,{id:f[e].id});this.started=!0,g[d.sigInst.id].dispatchEvent("start"),dagre.layout(b);var h;b.edges().map(function(a){h=d.sigInst.graph.edges(b.edge(a).id),h.points=b.edge(a).points}),this.stop()}},this.stop=function(){if(b){var e,f=b.nodes().map(function(a){return d.sigInst.graph.nodes(a)});if(this.boundingBox)var h=a(b.nodes().map(function(a){return b.node(a)}));if(this.running=!1,this.easing){for(var i=0;i<f.length;i++)this.boundingBox?(e=c(b.node(f[i].id),h,d.boundingBox),f[i].dagre_x=e.x,f[i].dagre_y=e.y):(f[i].dagre_x=b.node(f[i].id).x,f[i].dagre_y=b.node(f[i].id).y);g[d.sigInst.id].dispatchEvent("interpolate"),sigma.plugins.animate(d.sigInst,{x:"dagre_x",y:"dagre_y"},{nodes:f,easing:d.easing,onComplete:function(){for(var a=0;a<f.length;a++)f[a].dagre_x=null,f[a].dagre_y=null;g[d.sigInst.id].dispatchEvent("stop"),d.sigInst.refresh()},duration:d.duration})}else{var j;b.nodes().forEach(function(a){j=d.sigInst.graph.nodes(a),j.x=b.node(a).x,j.y=b.node(a).y}),g[d.sigInst.id].dispatchEvent("stop"),this.sigInst.refresh()}}},this.kill=function(){this.sigInst=null,this.config=null,this.easing=null}}if("undefined"==typeof sigma)throw new Error("sigma is not declared");if("undefined"==typeof dagre)throw new Error("dagre is not declared");if("undefined"==typeof dagre.graphlib)throw new Error("dagre.graphlib is not declared");sigma.utils.pkg("sigma.layouts.dagre");var e={directed:!0,multigraph:!0,compound:!1,rankDir:"TB"},f={},g={};sigma.layouts.dagre.configure=function(a,b){if(!a)throw new Error('Missing argument: "sigInst"');if(!b)throw new Error('Missing argument: "config"');return f[a.id]||(f[a.id]=new d,g[a.id]={},sigma.classes.dispatcher.extend(g[a.id]),a.bind("kill",function(){f[a.id].kill(),f[a.id]=null,g[a.id]=null})),f[a.id].init(a,b),g[a.id]},sigma.layouts.dagre.start=function(a,b){if(!a)throw new Error('Missing argument: "sigInst"');return b&&this.configure(a,b),f[a.id].start(),g[a.id]},sigma.layouts.dagre.isRunning=function(a){if(!a)throw new Error('Missing argument: "sigInst"');return!!f[a.id]&&f[a.id].running}}).call(this);
//# sourceMappingURL=sigma.layout.dagre.min.js.map